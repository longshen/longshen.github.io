<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: 项目管理 | longshen]]></title>
  <link href="http://longshen.github.io/blog/categories/xiang-mu-guan-li/atom.xml" rel="self"/>
  <link href="http://longshen.github.io/"/>
  <updated>2015-11-19T20:39:41+08:00</updated>
  <id>http://longshen.github.io/</id>
  <author>
    <name><![CDATA[longshen]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[文件同步工具_Seafile]]></title>
    <link href="http://longshen.github.io/blog/2015/11/16/file-syn-seafile/"/>
    <updated>2015-11-16T22:49:10+08:00</updated>
    <id>http://longshen.github.io/blog/2015/11/16/file-syn-seafile</id>
    <content type="html"><![CDATA[<blockquote><p>项目开发过程，团队成员经常协同编辑同一个文件。普通文档类的，可以使用自建的Confluence、Wordpress等，或者在线服务Worktitle、tower等。而<strong>像excel、思维导图（xmind）等复杂的文档文件</strong>，这些在线编辑协作的工具都未能支持，需要靠同步文件进行协作。</p>

<p>可惜 Dropbox 在国内多次遭屏蔽，而国产的百度云、快盘等产品也不太稳定。为保证协作效率，可以使用Seafile自建云存储平台。</p></blockquote>

<h2>服务器</h2>

<p>直接见<a href="http://www.centoscn.com/CentosServer/ftp/2015/0324/5003.html">Centos部署Seafile开源文件云存储服务器</a></p>

<blockquote><p>记得关闭防火墙</p>

<p><code>/sbin/iptables -I INPUT -p tcp --dport 8000 -j ACCEPT</code>
<code>/sbin/iptables -I INPUT -p tcp --dport 8082 -j ACCEPT</code></p></blockquote>

<h2>客户端</h2>

<p><a href="https://www.seafile.com/download/">Seafile官网下载链接</a></p>

<h2>其他问题</h2>

<h3>服务器宕机，数据如何恢复</h3>

<p>Seafile分两类数据，一类是数据库（用户信息等），一类是资料库数据（用户共享的文件库）。</p>

<p><strong>不备份的影响</strong>
第一类在SeaHub宕机（当然指数据无法恢复那种）后，则丢失了。
第二类有点像git，在客户端会有副本。在SeaHub重新启动后，可以从客户端重新提交。（具体丢失的数据量取决于客户端副本的更新时间）</p>

<p><strong>备份方法</strong>
1、备份数据
（不同路径、mysql账号密码、备份机器IP记得修改）</p>

<pre><code class="bash">#!/bin/bash
backup_dir="/usr/local/file/backup_db"
mysqldump_cmd="mysqldump -uroot -p123456 --opt"

$mysqldump_cmd ccnet-db &gt; $backup_dir/ccnet-db.sql.`date +"%Y-%m-%d-%H-%M-%S"`
$mysqldump_cmd seafile-db &gt; $backup_dir/seafile-db.sql.`date +"%Y-%m-%d-%H-%M-%S"`
$mysqldump_cmd seahub-db &gt; $backup_dir/seahub-db.sql.`date +"%Y-%m-%d-%H-%M-%S"`
echo "backup db success!"
rsync -va . root@10.10.159.176:/usr/local/file/
echo "sync data to 10.10.159.176 success!"
</code></pre>

<p>2、定时备份==
使用crontab定时执行第1步脚本。</p>

<pre><code class="bash">crontab -e
#添加如下执行任务（每天0点0分进行备份）
0 0 * * * /usr/local/file/backup_seafile_data.sh

#重新加载crontab配置
/sbin/service crond reload

#Note: 需要为脚本添加可执行权限，否则定时任务不生效
chmod +x /usr/local/file/backup_seafile_data.sh
</code></pre>

<p>rsyc方法参考<a href="https://longshen.github.io/blog/2015/11/18/sync-file-between-linux/">Linux间传输文件</a>
具体备份内容细见<a href="http://manual-cn.seafile.com/maintain/backup_recovery.html">Seafile备份与恢复</a></p>

<h2>参考</h2>

<p><a href="http://manual-cn.seafile.com/index.html">Seafile服务器中文手册</a></p>
]]></content>
  </entry>
  
</feed>
